<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrew's English | Online Classroom</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a73e8; --success: #2d8a57; --error: #c53030; --line: #06C755; --fb: #1877F2; --bg: #f8f9fa; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        .app-container { width: 100%; max-width: 800px; }
        
        .school-header { text-align: center; margin-bottom: 30px; display: flex; justify-content: center; }
        .school-logo { max-width: 300px; max-height: 120px; width: auto; height: auto; }
        
        .card { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #eee; margin-bottom: 20px; position: relative; }
        
        /* Persistent Tense Header in Quiz */
        .tense-indicator { font-size: 0.9rem; font-weight: 700; color: var(--primary); text-transform: uppercase; margin-bottom: 15px; display: block; border-bottom: 1px solid #f0f0f0; padding-bottom: 10px; }

        /* FIXED: Lesson Boxes - Solid Blue with White English and Chinese Text */
        .lesson-btn { 
            text-align: center; 
            padding: 25px; 
            margin-bottom: 15px; 
            width: 100%; 
            border: none; 
            background-color: #1a73e8; /* Solid Blue */
            color: #ffffff !important; /* Force White Text */
            cursor: pointer; 
            border-radius: 12px; 
            transition: background 0.2s;
            display: block;
        }
        .lesson-btn:hover { background-color: #1557b0; }
        
        .btn-en { font-size: 1.4rem; font-weight: 700; display: block; margin-bottom: 4px; }
        .btn-cn { font-size: 1.1rem; font-weight: 400; display: block; }

        /* General Styles */
        .usage-box { background: #e8f0fe; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 5px solid var(--primary); }
        .rule-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.9rem; background: #fff; }
        .rule-table th { background-color: #f1f3f4; color: var(--primary); padding: 12px; border: 1px solid #ddd; text-align: left; }
        .rule-table td { border: 1px solid #ddd; padding: 12px; vertical-align: top; }
        
        .q-translation { display: block; font-size: 1rem; color: #666; margin-top: 5px; }
        input[type="text"] { width: 100%; padding: 15px; font-size: 1.1rem; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box; margin-bottom: 20px; }
        
        .share-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .btn-line { background: var(--line); color: white; }
        .btn-fb { background: var(--fb); color: white; }

        #hint-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 12px; width: 90%; max-width: 700px; }
        
        @media print { .no-print { display: none; } }
    </style>
</head>
<body>

<div class="app-container">
    <header class="school-header">
        <img src="logo.png" alt="Andrew's English" class="school-logo">
    </header>

    <div id="login-card" class="card">
        <h2 style="text-align:center;">Student's Name <span style="font-size: 0.8rem; color:#666;">å­¸ç”Ÿå§“å</span></h2>
        <input type="text" id="student-name" placeholder="Enter your full name">
        <button style="width:100%; background:var(--primary); color:white; padding:15px; border-radius:8px; border:none; font-weight:bold;" onclick="goToMenu()">Enter Classroom / é€²å…¥æ•™å®¤</button>
    </div>

    <div id="menu-card" class="card" style="display:none;">
        <h3 id="welcome-msg" style="color: var(--primary); text-align: center; margin-bottom: 25px;"></h3>
        <h2 style="text-align: center; margin-bottom: 30px;">Select a Lesson / é¸æ“‡èª²ç¨‹</h2>
        
        <button class="lesson-btn" onclick="loadTense('present')">
            <span class="btn-en">Present Simple</span>
            <span class="btn-cn">ç¾åœ¨ç°¡å–®å¼</span>
        </button>
        
        <button class="lesson-btn" onclick="loadTense('past')">
            <span class="btn-en">Past Simple</span>
            <span class="btn-cn">éå»ç°¡å–®å¼</span>
        </button>
        
        <button class="lesson-btn" onclick="loadTense('future')">
            <span class="btn-en">Future Simple</span>
            <span class="btn-cn">æœªä¾†ç°¡å–®å¼</span>
        </button>
    </div>

    <div id="rule-card" class="card" style="display:none;">
        <div id="rule-content"></div>
        <button style="width:100%; background: var(--success); color:white; padding:15px; border:none; border-radius:8px; font-weight:bold;" onclick="startQuiz()">Start Quiz / é–‹å§‹æ¸¬é©—</button>
        <button style="width:100%; background:#666; color:white; margin-top:10px; border:none; border-radius:8px; padding:10px;" onclick="backToMenu()">Back / è¿”å›</button>
    </div>

    <div id="quiz-container" class="card" style="display:none;">
        <div id="question-area"></div>
        <button style="background: #666; color:white; font-size: 0.8rem; padding: 10px; width:100%; margin-top:20px; border:none; border-radius:8px;" onclick="toggleHint()">ğŸ’¡ Check Rules / æŸ¥çœ‹è¦å‰‡</button>
    </div>

    <div id="results-container" class="card" style="display:none;">
        <h2 id="result-title" style="text-align:center;">Quiz Results</h2>
        <div id="score-summary"></div>
        <div id="report-list"></div>
        <div class="no-print">
            <div class="share-container">
                <button class="btn-line" style="padding:15px; border:none; border-radius:8px; font-weight:bold;" onclick="shareToSocial('line')">LINE</button>
                <button class="btn-fb" style="padding:15px; border:none; border-radius:8px; font-weight:bold;" onclick="shareToSocial('facebook')">Facebook</button>
            </div>
        </div>
        <button style="width:100%; background: var(--primary); color:white; margin-top:20px; padding:15px; border:none; border-radius:8px; font-weight:bold;" class="no-print" onclick="backToMenu()">Try Another Lesson</button>
    </div>
</div>

<div id="hint-modal">
    <div class="modal-content"><div id="modal-inner"></div><button style="background: #d93025; color:white; width:100%; border:none; padding:10px; border-radius:8px;" onclick="toggleHint()">Close / é—œé–‰</button></div>
</div>

<script>
    var studentName = "";
    var currentTense = "";
    var currentIdx = 0;
    var studentAnswers = [];
    
    var data = {
        present: {
            title: "Present Simple ç¾åœ¨ç°¡å–®å¼",
            usage: "Habits and facts. / ç¿’æ…£èˆ‡äº‹å¯¦ã€‚",
            questions: [
                { q: "She ___ (eat) an apple every morning.", t: "å¥¹æ¯å¤©æ—©ä¸Šåƒä¸€å€‹è˜‹æœã€‚", a: "eats" },
                { q: "They ___ (not like) cold weather.", t: "ä»–å€‘ä¸å–œæ­¡å¯’å†·çš„å¤©æ°£ã€‚", a: "do not like" },
                { q: "He ___ (play) the piano very well.", t: "ä»–é‹¼ç´å½ˆå¾—å¾ˆå¥½ã€‚", a: "plays" },
                { q: "I ___ (not drink) coffee in the evening.", t: "æˆ‘æ™šä¸Šä¸å–å’–å•¡ã€‚", a: "do not drink" },
                { q: "The sun ___ (rise) in the east.", t: "å¤ªé™½å¾æ±é‚Šå‡èµ·ã€‚", a: "rises" },
                { q: "We ___ (not watch) TV on weekdays.", t: "æˆ‘å€‘å¹³æ—¥ä¸çœ‹é›»è¦–ã€‚", a: "do not watch" },
                { q: "My cat ___ (sleep) on the sofa.", t: "æˆ‘çš„è²“ç¡åœ¨æ²™ç™¼ä¸Šã€‚", a: "sleeps" },
                { q: "You ___ (not speak) Spanish fluently.", t: "ä½ çš„è¥¿ç­ç‰™èªèªªå¾—ä¸æµåˆ©ã€‚", a: "do not speak" },
                { q: "It ___ (rain) a lot in April.", t: "å››æœˆå¸¸ä¸‹é›¨ã€‚", a: "rains" },
                { q: "Birds ___ (not fly) south in the summer.", t: "é³¥é¡åœ¨å¤å¤©ä¸æœƒé£›å¾€å—æ–¹ã€‚", a: "do not fly" }
            ],
            table: `<table class="rule-table"><tr><th>Subject (ä¸»è©)</th><th>Affirmative (è‚¯å®š)</th><th>Negative (å¦å®š)</th></tr><tr><td>I / You / We / They</td><td>Base verb</td><td>do not + verb</td></tr><tr><td>He / She / It</td><td>verb + s/es</td><td>does not + verb</td></tr></table>`
        },
        past: {
            title: "Past Simple éå»ç°¡å–®å¼",
            usage: "Finished actions. / éå»å·²å®Œæˆçš„å‹•ä½œã€‚",
            questions: [
                { q: "We ___ (visit) the museum yesterday.", t: "æˆ‘å€‘æ˜¨å¤©åƒè§€äº†åšç‰©é¤¨ã€‚", a: "visited" },
                { q: "I ___ (not see) the movie last night.", t: "æˆ‘æ˜¨æ™šæ²’çœ‹é‚£éƒ¨é›»å½±ã€‚", a: "did not see" },
                { q: "He ___ (buy) a new bike last week.", t: "ä»–ä¸Šé€±è²·äº†ä¸€è¼›æ–°å–®è»Šã€‚", a: "bought" },
                { q: "They ___ (not go) to the party.", t: "ä»–å€‘æ²’å»åƒåŠ æ´¾å°ã€‚", a: "did not go" },
                { q: "She ___ (finish) her homework early.", t: "å¥¹å¾ˆæ—©å°±å®Œæˆäº†åŠŸèª²ã€‚", a: "finished" },
                { q: "You ___ (not call) me on my birthday.", t: "ä½ ç”Ÿæ—¥é‚£å¤©æ²’æ‰“é›»è©±çµ¦æˆ‘ã€‚", a: "did not call" },
                { q: "The dog ___ (bark) at the mailman.", t: "é‚£éš»ç‹—å°è‘—éƒµå·®å å«ã€‚", a: "barked" },
                { q: "It ___ (not snow) last winter.", t: "å»å¹´å†¬å¤©æ²’ä¸‹é›ªã€‚", a: "did not snow" },
                { q: "We ___ (eat) pizza for dinner.", t: "æˆ‘å€‘æ™šé¤åƒäº†æŠ«è–©ã€‚", a: "ate" },
                { q: "He ___ (not lose) his keys.", t: "ä»–æ²’æœ‰å¼„ä¸Ÿä»–çš„é‘°åŒ™ã€‚", a: "did not lose" }
            ],
            table: `<table class="rule-table"><tr><th>Subject (ä¸»è©)</th><th>Affirmative (è‚¯å®š)</th><th>Negative (å¦å®š)</th></tr><tr><td>All Subjects</td><td>verb + ed</td><td>did not + verb</td></tr></table>`
        },
        future: {
            title: "Future Simple æœªä¾†ç°¡å–®å¼",
            usage: "Future plans or predictions. / æœªä¾†è¨ˆç•«æˆ–é æ¸¬ã€‚",
            questions: [
                { q: "I ___ (help) you with your bags.", t: "æˆ‘æœƒå¹«ä½ æåŒ…åŒ…ã€‚", a: "will help" },
                { q: "She ___ (not forget) her umbrella.", t: "å¥¹ä¸æœƒå¿˜è¨˜å¸¶å‚˜ã€‚", a: "will not forget" },
                { q: "They ___ (arrive) at 6 PM.", t: "ä»–å€‘æœƒåœ¨ä¸‹åˆå…­é»åˆ°é”ã€‚", a: "will arrive" },
                { q: "We ___ (not stay) late at the park.", t: "æˆ‘å€‘ä¸æœƒåœ¨å…¬åœ’å¾…åˆ°å¾ˆæ™šã€‚", a: "will not stay" },
                { q: "You ___ (enjoy) the concert tonight.", t: "ä½ æœƒå–œæ­¡ä»Šæ™šçš„éŸ³æ¨‚æœƒã€‚", a: "will enjoy" },
                { q: "He ___ (not eat) the spicy soup.", t: "ä»–ä¸æœƒå–é€™ç¢—è¾£æ¹¯ã€‚", a: "will not eat" },
                { q: "It ___ (be) sunny tomorrow.", t: "æ˜å¤©æœƒæ˜¯æ™´å¤©ã€‚", a: "will be" },
                { q: "I ___ (not wear) a coat today.", t: "æˆ‘ä»Šå¤©ä¸æœƒç©¿å¤–å¥—ã€‚", a: "will not wear" },
                { q: "The bus ___ (stop) here soon.", t: "å…¬è»Šå¾ˆå¿«å°±æœƒåœåœ¨é€™è£¡ã€‚", a: "will stop" },
                { q: "They ___ (not play) outside if it rains.", t: "å¦‚æœä¸‹é›¨ï¼Œä»–å€‘å°±ä¸æœƒåœ¨å¤–é¢ç©ã€‚", a: "will not play" }
            ],
            table: `<table class="rule-table"><tr><th>Subject (ä¸»è©)</th><th>Affirmative (è‚¯å®š)</th><th>Negative (å¦å®š)</th></tr><tr><td>All Subjects</td><td>will + verb</td><td>will not + verb</td></tr></table>`
        }
    };

    function goToMenu() {
        var input = document.getElementById('student-name');
        if (input.value.trim() === "") { alert("Please enter your name."); return; }
        studentName = input.value.trim();
        document.getElementById('login-card').style.display = "none";
        document.getElementById('menu-card').style.display = "block";
        document.getElementById('welcome-msg').innerText = "Welcome, " + studentName + "!";
    }

    function backToMenu() {
        currentIdx = 0; studentAnswers = [];
        document.getElementById('rule-card').style.display = 'none';
        document.getElementById('results-container').style.display = 'none';
        document.getElementById('menu-card').style.display = 'block';
    }

    function loadTense(tense) {
        currentTense = tense;
        var guideHtml = `<h2 style="color:var(--primary); text-align:center;">${data[tense].title}</h2><div class="usage-box"><strong>Usage:</strong> ${data[tense].usage}</div>${data[tense].table}`;
        document.getElementById('rule-content').innerHTML = guideHtml;
        document.getElementById('modal-inner').innerHTML = guideHtml;
        document.getElementById('menu-card').style.display = 'none';
        document.getElementById('rule-card').style.display = 'block';
    }

    function toggleHint() {
        var modal = document.getElementById('hint-modal');
        modal.style.display = (modal.style.display === 'block') ? 'none' : 'block';
    }

    function startQuiz() {
        document.getElementById('rule-card').style.display = 'none';
        document.getElementById('quiz-container').style.display = 'block';
        showQuestion();
    }

    function showQuestion() {
        var item = data[currentTense].questions[currentIdx];
        document.getElementById('question-area').innerHTML = `
            <div class="tense-indicator" style="text-align:center;">${data[currentTense].title}</div>
            <p style="text-align:center; color:#666; font-size: 0.8rem;">Question ${currentIdx + 1} of 10</p>
            <h3 style="text-align:center; margin-bottom: 5px;">${item.q}</h3>
            <span class="q-translation" style="text-align:center; margin-bottom: 25px; display:block;">${item.t}</span>
            <input type="text" id="user-input" autocomplete="off" onkeypress="if(event.key==='Enter') next()">
            <button style="width:100%; background:var(--primary); color:white; border:none; padding:15px; border-radius:8px; font-weight:bold;" onclick="next()">Submit Answer</button>`;
        document.getElementById('user-input').focus();
    }

    function next() {
        studentAnswers.push(document.getElementById('user-input').value);
        currentIdx++;
        if (currentIdx < 10) showQuestion(); else showResults();
    }

    function normalize(text) {
        if (!text) return "";
        return text.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
    }

    function showResults() {
        document.getElementById('quiz-container').style.display = 'none';
        document.getElementById('results-container').style.display = 'block';
        var score = 0;
        for (var i = 0; i < 10; i++) {
            if (normalize(studentAnswers[i]) === normalize(data[currentTense].questions[i].a)) score++;
        }
        document.getElementById('score-summary').innerHTML = `<h3 style="text-align:center;">Grade: ${score * 10}%</h3>`;
    }

    function shareToSocial(platform) {
        var msg = studentName + " scored well in " + data[currentTense].title + "!";
        if(platform === 'line') window.open("https://line.me/R/msg/text/?" + encodeURIComponent(msg), '_blank');
        else window.open("https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(window.location.href), '_blank');
    }
</script>
</body>
</html>
